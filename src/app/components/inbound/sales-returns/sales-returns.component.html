<div id="inBody" [dir]="direction">
  <div class="col-md-12">
    <!--  <div class="row">
      <div class="col-md-4">
      </div>
      <div class="col-md-4 offset-md-4">
        <div class="udcBtns float-right">
          <ul>
            <li (click)="exportAsXLSX()"><a> <i class="material-icons align-middle"> get_app </i> Download Excel</a>
            </li>
          </ul>
        </div>
      </div>
    </div> -->
    <form [formGroup]="salesForm">
      <div class="row">
        <div class="col-md-12">
          <div class="panel portlet">
            <div class="formBox portlet-title">
              <div class="row">
                <div class="panel-heading formTitle w-auto">
                  <h4>{{'SALES RETURN' |translate}}</h4>
                  <div class="float-right"><span class="clickable"><i class="fa fa-angle-up"
                        aria-hidden="true"></i></span> | <i class="material-icons fullscreen">
                      unfold_less </i> </div>
                </div>
                <div class="formTitleHover">
                  <h4>{{'SALES RETURN' |translate}}
                    <div class="float-right"><i class="material-icons fullscreen"> close </i></div>
                  </h4>
                </div>
              </div>
              <div id="style-8" class="panel-body ">
                <div class="row">
                  <div class="col-md-6">
                    <div class="form-group row">
                      <label class="col-sm-4 col-form-label">{{'WMSO Number' |translate}}
                      </label>
                      <div class="col-sm-4">
                        <ng2-completer name="fullWmsoNumber" [datasource]="wmsoNumbers" id="fullWmsoNumber"
                          formControlName="fullWmsoNumber" [minSearchLength]="0" placeholder="{{'SO Number' |translate}}"
                          (selected)="onWMSONoChange($event)" [disabled]="salesForm.controls._id.value"
                          [inputClass]="'form-control form-control-inline'">
                        </ng2-completer>
                      </div>
                    </div>
                    <div class="form-group row"formGroupName="customerMasterInfo">
                      <label class="col-sm-4 col-form-label">{{'Customers ID' |translate}}
                      </label>
                      <div class="col-sm-4 top-input">
                        <input type="text" class="form-control" 
                        formControlName="customerID" [readonly]="readOnlyMode" placeholder="Customers ID">
                      </div>
                    </div>
                    <div class="form-group row" formGroupName="customerMasterInfo">
                      <label class="col-sm-4 col-form-label">{{'Customers Name' |translate}}
                      </label>
                      <div class="col-sm-4 top-input">
                        <input type="text" class="form-control" formControlName="customerName" placeholder="Customers Name"
                          [readonly]="readOnlyMode">
                      </div>
                    </div>
                  </div>
                  <div class="col-md-6">
                    <div class="form-group row">
                      <label class="col-sm-4 col-form-label">{{'Customers Supplier Name' |translate}}
                      </label>
                      <div class="col-sm-4 top-input">
                        <input type="text" class="form-control" formControlName="customersCustomerName"
                          [readonly]="readOnlyMode" placeholder="{{'Customers Supplier Name' |translate}}">
                      </div>
                    </div>
                    <div class="form-group row">
                      <label class="col-sm-4 col-form-label">{{'Customers Supplier Address' |translate}}
                      </label>
                      <div class="col-sm-4 top-input">
                        <input type="text" class="form-control" formControlName="customersCustomerAddress"
                          [readonly]="readOnlyMode" placeholder="{{'Customers Supplier Address' |translate}}">
                      </div>
                    </div>
                  </div>
                </div>
                <div class="col-md-12">
                  
                </div>
              </div>
            </div>
          </div>
          <div class="text-right">
            <div class="form-group row">
              <label class="col-sm-4 col-form-label"> </label>
              <div class="col-sm-8 text-right mb-3">
                <button class="btn btn-green mr-1" (click)="generate()" [disabled]="!salesForm.controls.wmsoNumber.value ||
                salesForm.controls.salesReturnStatus.value=='Confirmed'">{{'Create' |translate}}</button>
                <button class="btn btn-green mr-1" (click)="confirm()" [disabled]="!salesForm.controls._id.value ||
                salesForm.controls.salesReturnStatus.value=='Confirmed'">{{'Confirm' |translate}}</button>
                <button class="btn btn-white" (click)="clear()">{{'Clear' |translate}}</button>
              </div>
            </div>
          </div>
          
        </div>
      </div>
    </form>
    <div class="row">
      <div class="col-md-12">
        <div id="scrolTable" class="wmsDataTables">
          <table id="example" class="table table-striped" datatable [dtOptions]="dtOptions" [dtTrigger]="dtTrigger2">
            <thead>
              <tr>
                <th scope="col">{{'S.No' |translate}}</th>
                <th scope="col">{{'Image'|translate}}</th>
                <th scope="col">{{'Include' |translate}}</th>
                <th scope="col">{{'WMSO Line No' |translate}}</th>
                <th scope="col">{{'Product ID' |translate}}</th>
                <th scope="col">{{'Product Name' |translate}}</th>
                <th scope="col">{{'UOM' |translate}}</th>
                <th scope="col">{{'Shipped Quantity' |translate}}</th>
                <th scope="col">{{'Total Return Quantity' |translate}}</th>
                <th scope="col">{{'Return Quantity' |translate}}</th>
                <th scope="col">{{'ETA' |translate}}</th>
              </tr>
            </thead>
            <tbody *ngIf="wmsoLinesArray.length>0">
              <tr *ngFor="let data of wmsoLinesArray;let i=index">
                <td class="text-left">{{i+1}}</td>
                <td *ngIf="data.productImageResource">
                  <div class="tooltip-container">
                    <img [src]="'data:image/jpg;base64,' + data.productImageResource" class="pImageIcon"
                      alt="No Preview available" (mouseover)="showTooltip = true" (mouseleave)="showTooltip = false">
                    <span *ngIf="showTooltip" class="tooltip-text">{{data.productMasterInfo.productName}}</span>
                  </div>
                </td>
                <td *ngIf="!data.productImageResource">
                  <div class="noImageIcon">
                    <p class="noImageIconText">
                      {{configService.getImageShortCut(data.productMasterInfo.productName)}}</p>
                  </div>
                </td>
                <td><input type="checkbox" [checked]="data.isChecked" (click)="onSelect($event.target.checked,data)"
                    [disabled]="salesForm.controls.salesReturnStatus.value=='Confirmed' || disableMe"></td>
                <td >{{data.wmsoLineNumber}}</td>
                <td >{{data.productMasterInfo.productID}}</td>
                <td>{{data.productMasterInfo.productName}}</td>
                <td class="text-center">{{data.shipmentUnit}}</td>
                <td >{{data.customerDispatchQuantity | decimalwithTenDigits}}</td>
                <td >{{data.totalReturnQuantity | decimalwithTenDigits}}</td>
                <td><span *ngIf="!data.isEdit">{{data.returnQuantity | decimalwithTenDigits}}</span>
                  <span *ngIf="data.isEdit"><input type="text" class="form-control" #returnQuantity
                      [(ngModel)]="data.returnQuantity" (keyup)="validateDecimal('returnQuantity',i)"
                      (focusout)="savequantity(returnQuantity.value,data,'returnQuantity')"></span>
                </td>
                <td><span *ngIf="!data.isEdit">{{data.expectedDeliveryDate | date:'dd/MM/yyyy'}}</span>
                  <span *ngIf="data.isEdit"><input type="date" class="form-control" #expectedDeliveryDate
                      [value]="data.expectedDeliveryDate"
                      (focusout)="saveETADate(expectedDeliveryDate.value,data,'expectedDeliveryDate')"></span>
                </td>
              </tr>
            </tbody>
          </table>
        </div>
      </div>
    </div>
    <div class="row">
      <div class="col-md-12">
        <div id="scrolTable" class="wmsDataTables">
          <table id="example" class="table table-striped" datatable [dtOptions]="dtOptions" [dtTrigger]="dtTrigger">
            <thead>
              <tr>
                <th scope="col">{{'S.No' |translate}}</th>
                <th scope="col">{{'Return ID' |translate}}</th>
                <th scope="col">{{'WMSO Number' |translate}}</th>
                <th scope="col">{{'Customer' |translate}}</th>
                <th scope="col">{{'Order Type' |translate}}</th>
                <th scope="col">{{'Status' |translate}}</th>
                <th scope="col">{{'Action' |translate}}</th>
              </tr>
            </thead>
            <tbody>
              <tr *ngFor="let data of SRData;let i=index">
                <td class="text-left">{{i+1}}</td>
                <th (click)="edit(data)" style="cursor:pointer;" >{{data.fullWmsrNumber}}</th>
                <td>{{data.fullWmsoNumber}} </td>
                <td >{{data.customerMasterInfo?.customerIDName}}</td>
                <td>{{data.orderType}}</td>
                <td [ngStyle]="{'color':(data.salesReturnStatus=='Confirmed') ?'#15d6cc':'grey'}">{{data.salesReturnStatus}}</td>
               <!--  <td>{{data.salesReturnStatus}}</td> -->
                <td><span _ngcontent-lty-c40="" class="btn btn-pink btn-sm">
                    <!-- <i _ngcontent-lty-c40="" class="fa fa-pencil btn-sm" (click)="edit(data)"></i> -->
                    <i _ngcontent-lty-c40="" class="fa fa-trash btn-sm" (click)="delete(data)"></i>
                  </span></td>
              </tr>
            </tbody>
          </table>
        </div>
      </div>
    </div>
  </div>
  <!-- <div class="row">
    <div class="col-md-12 mb-2">
      <div class="text-center">
        <button class="btn btn-primary">{{'Create' |translate}} Return</button>
      </div>
    </div>
  </div> -->
</div>
<app-delete-popup [getInfo]="deleteInfo" (sendConfirmation)="getConfirmation($event)"></app-delete-popup>
